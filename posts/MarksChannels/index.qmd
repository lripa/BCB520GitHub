---
title: “ASSIGNMENT 4”

subtitle: “Marks and Channels”

author: “Lucas”

date: February 6, 2024  

image: "weevil.jpg" 

categories: [Assignment, DataViz]

code-fold: true

code-tools: true

description: “Let's try some bar graphs and basic data viz for an insecticide trial”
---

What I did here was to prepare a separate bar graph for each evaluation date: before the application of the insecticides, 7 days post-application (DPA), 14 DPA, 21 DPA, 28 DPA, and 35 DPA. Upon examining the graphs, the weevil population appears to remain quite low even at 35 DPA. A specific color was selected for each treatment and maintained as a color code for all the graphs.

```{r}
library(readxl)
Weevils <- read_excel("~/Mi unidad/Uidaho/Clases/PhD/Spring 2024/BCB 520/Data/Weevils.xlsx")
head(Weevils)
library(tidyverse)
Bmeans <-Weevils %>%
  group_by(`Insecticide Name`) %>%
  summarise(AVG = mean(Before),
            AVG1 = mean(`7 dpa`, na.rm = TRUE), AVG2 = mean(`14 dpa`, na.rm = TRUE), AVG3 = mean(`21 dpa`, na.rm = TRUE), AVG4 = mean(`28 dpa`, na.rm = TRUE), AVG5 = mean(`35 dpa`, na.rm = TRUE) )
library(ggplot2)
# Example with a custom color palette
my_colors <- c("green", "cyan", "blue", "darkblue", "gold", "black")
ggplot(Bmeans, aes(x = `Insecticide Name`, y = AVG, fill = `Insecticide Name`)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = my_colors) +
  labs(title = "Mean weevils per plant before treatments",
       x = "Insecticides",
       y = "Mean weevils/Plant") +
  theme(axis.text.x = element_text(angle = 10, vjust = 0.5, hjust = 1))

ggplot(Bmeans, aes(x = `Insecticide Name`, y = AVG1, fill = `Insecticide Name`)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = my_colors) +
  labs(title = "Mean weevils per plant 7 DPA",
       x = "Insecticides",
       y = "Mean weevils/Plant") +
  theme(axis.text.x = element_text(angle = 10, vjust = 0.5, hjust = 1))

ggplot(Bmeans, aes(x = `Insecticide Name`, y = AVG2, fill = `Insecticide Name`)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = my_colors) +
  labs(title = "Mean weevils per plant 14 DPA",
       x = "Insecticides",
       y = "Mean weevils/Plant") +
  theme(axis.text.x = element_text(angle = 10, vjust = 0.5, hjust = 1))

ggplot(Bmeans, aes(x = `Insecticide Name`, y = AVG3, fill = `Insecticide Name`)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = my_colors) +
  labs(title = "Mean weevils per plant 21 DPA",
       x = "Insecticides",
       y = "Mean weevils/Plant") +
  theme(axis.text.x = element_text(angle = 10, vjust = 0.5, hjust = 1))

ggplot(Bmeans, aes(x = `Insecticide Name`, y = AVG4, fill = `Insecticide Name`)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = my_colors) +
  labs(title = "Mean weevils per plant 28 DPA",
       x = "Insecticides",
       y = "Mean weevils/Plant") +
  theme(axis.text.x = element_text(angle = 10, vjust = 0.5, hjust = 1))

ggplot(Bmeans, aes(x = `Insecticide Name`, y = AVG5, fill = `Insecticide Name`)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = my_colors) +
  labs(title = "Mean weevils per plant 35 DPA",
       x = "Insecticides",
       y = "Mean weevils/Plant") +
  theme(axis.text.x = element_text(angle = 10, vjust = 0.5, hjust = 1))

```
