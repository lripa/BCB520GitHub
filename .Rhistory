filter(TotalAmount >= 200000) %>%  # Filter step added here
arrange(desc(TotalAmount))
ggplot(total_amount_per_PI, aes(x = PI, y = TotalAmount / 1e6)) +
geom_bar(stat = "identity") +
labs(title = "NIH Total Funding per PI in the Last 10 Years",
y = "Total Funding Amount (USD Millions)",
x = "Principal Investigator") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate X-axis labels for readability
library(readxl)
library(dplyr)
library(ggplot2)
BU <- read_xlsx("NIH.xlsx")
# Use 'BU' instead of 'df' for operations
selected_universities <- BU %>%
filter(organization.org_name %in% c("BOISE STATE UNIVERSITY", "UNIVERSITY OF IDAHO")) %>%
group_by(organization.org_name) %>%
summarise(total_award_amount = sum(award_amount, na.rm = TRUE))
# Create the bar chart
ggplot(selected_universities, aes(x = organization.org_name, y = total_award_amount, fill = organization.org_name)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Total Award Amount by University NIH",
x = "University",
y = "Total Award Amount NIH") +
theme_minimal() +
scale_fill_manual(values = c("BOISE STATE UNIVERSITY" = "blue", "UNIVERSITY OF IDAHO" = "gold"))
# Load necessary libraries
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
# Read the CSV file
data <- read_csv("USDAallU.csv")
# Convert 'Award Date' to Date object using correct format and filter data from 2014 to 2024
data <- data %>%
mutate(AwardDate = mdy(`Award Date`)) %>%
filter(AwardDate >= as.Date("2014-01-01") & AwardDate <= as.Date("2024-12-31"))
# Aggregate data to get the total Award Dollars for each Grantee Name
total_award_per_grantee <- data %>%
group_by(`Grantee Name`) %>%
summarise(TotalAwardDollars = sum(`Award Dollars`, na.rm = TRUE)) %>%
arrange(desc(TotalAwardDollars)) # Optional: arrange in descending order of total award dollars
# Assuming total_award_per_grantee is already created from previous steps
# Convert Grantee Name to a factor (if not already)
total_award_per_grantee$`Grantee Name` <- factor(total_award_per_grantee$`Grantee Name`)
# Assuming custom_colors is correctly mapped to your Grantee Names
custom_colors <- c("Boise State University" = "blue",
"University of Idaho" = "gold",
"Washington State University" = "red",
"University of Montana" = "tan")
ggplot(total_award_per_grantee, aes(x = reorder(`Grantee Name`, TotalAwardDollars), y = TotalAwardDollars / 1e6, fill = `Grantee Name`)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = c("Boise State University" = "blue",
"University of Idaho" = "gold",
"Washington State University" = "red",
"University of Montana" = "tan")) +
labs(title = "USDA Total Award Dollars per University (2014-2024)",
x = "Grantee Name",
y = "Total Award Dollars (Millions USD)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  # For better readability of Grantee Names
# Load necessary libraries
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
# Read the CSV file
data <- read_csv("USDAallU.csv")
# Convert 'Award Date' to Date object using correct format and filter data from 2014 to 2024
data <- data %>%
mutate(AwardDate = mdy(`Award Date`)) %>%
filter(AwardDate >= as.Date("2014-01-01") & AwardDate <= as.Date("2024-12-31"))
# Aggregate data to get the total Award Dollars for each Grantee Name
total_award_per_grantee <- data %>%
group_by(`Grantee Name`) %>%
summarise(TotalAwardDollars = sum(`Award Dollars`, na.rm = TRUE)) %>%
arrange(desc(TotalAwardDollars)) # Optional: arrange in descending order of total award dollars
# Assuming total_award_per_grantee is already created from previous steps
# Convert Grantee Name to a factor (if not already)
total_award_per_grantee$`Grantee Name` <- factor(total_award_per_grantee$`Grantee Name`)
# Assuming custom_colors is correctly mapped to your Grantee Names
custom_colors <- c("Boise State University" = "blue",
"University of Idaho" = "gold",
"Washington State University" = "red",
"University of Montana" = "tan")
ggplot(total_award_per_grantee, aes(x = reorder(`Grantee Name`, TotalAwardDollars), y = TotalAwardDollars / 1e6, fill = `Grantee Name`)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = c("Boise State University" = "blue",
"University of Idaho" = "gold",
"Washington State University" = "red",
"University of Montana" = "tan")) +
labs(title = "USDA Total Award Dollars per University (2014-2024)",
x = "Grantee Name",
y = "Total Award Dollars (Millions USD)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  # For better readability of Grantee Names
library(dplyr)
library(ggplot2)
# Assuming 'funding_data' is your dataset
# Count the number of grants per Grantee Name
grants_per_grantee <- funding_data %>%
group_by(Grantee Name) %>%
library(readr)
library(dplyr)
library(ggplot2)
# If 'funding_data' is not yet loaded, replace "USDAallU.csv" with your actual file path
funding_data <- read_csv("USDAallU.csv")
# Assuming the dataset is correctly loaded into funding_data
# Count the number of grants per Grantee Name
grants_per_grantee <- funding_data %>%
group_by(`Grantee Name`) %>%
summarise(NumberOfGrants = n()) %>%
arrange(desc(NumberOfGrants))  # Arrange in descending order of number of grants
# Create the bar graph
ggplot(grants_per_grantee, aes(x = reorder(`Grantee Name`, NumberOfGrants), y = NumberOfGrants)) +
geom_bar(stat = "identity", fill = "skyblue") +  # Using a single color for simplicity
labs(title = "Number of Grants per Grantee",
x = "Grantee Name",
y = "Number of Grants") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  # Rotate X-axis labels for better readability
library(readr)
library(dplyr)
library(ggplot2)
# If 'funding_data' is not yet loaded, replace "USDAallU.csv" with your actual file path
funding_data <- read_csv("USDAallU.csv")
# Assuming the dataset is correctly loaded into funding_data
# Count the number of grants per Grantee Name
grants_per_grantee <- funding_data %>%
group_by(`Grantee Name`) %>%
summarise(NumberOfGrants = n()) %>%
arrange(desc(NumberOfGrants))  # Arrange in descending order of number of grants
# Define custom colors for each Grantee Name (example)
custom_colors <- c("Grantee Name 1" = "red", "Grantee Name 2" = "blue", "Grantee Name 3" = "green")
# Then use scale_fill_manual in your ggplot call
ggplot(grants_per_grantee, aes(x = reorder(`Grantee Name`, NumberOfGrants), y = NumberOfGrants, fill = `Grantee Name`)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
# Other ggplot settings remain the same
library(readr)
library(dplyr)
library(ggplot2)
# Assuming the dataset is correctly loaded into funding_data
# Count the number of grants per Grantee Name
grants_per_grantee <- funding_data %>%
group_by(`Grantee Name`) %>%
summarise(NumberOfGrants = n()) %>%
arrange(desc(NumberOfGrants))  # Arrange in descending order of number of grants
# Create the bar graph with automatic color assignment
ggplot(grants_per_grantee, aes(x = reorder(`Grantee Name`, NumberOfGrants), y = NumberOfGrants, fill = `Grantee Name`)) +
geom_bar(stat = "identity") +
labs(title = "Number of Grants per Grantee",
x = "Grantee Name",
y = "Number of Grants") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + # Rotate X-axis labels for better readability
scale_fill_viridis_d() # Use Viridis color scale for distinct colors
library(readr)
library(dplyr)
library(ggplot2)
# Assuming the dataset is correctly loaded into funding_data
grants_per_grantee <- funding_data %>%
group_by(`Grantee Name`) %>%
summarise(NumberOfGrants = n()) %>%
arrange(desc(NumberOfGrants))  # Arrange in descending order of number of grants
# Create the bar graph with automatic color assignment
ggplot(grants_per_grantee, aes(x = reorder(`Grantee Name`, NumberOfGrants), y = NumberOfGrants, fill = `Grantee Name`)) +
geom_bar(stat = "identity") +
labs(title = "Number of Grants per Grantee",
x = "Grantee Name",
y = "Number of Grants") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + # Rotate X-axis labels for better readability
scale_fill_viridis_d() # Use Viridis color scale for distinct colors
library(readr)
library(dplyr)
library(ggplot2)
# Assuming the dataset is correctly loaded into funding_data
grants_per_grantee <- funding_data %>%
group_by(`Grantee Name`) %>%
summarise(NumberOfGrants = n()) %>%
arrange(desc(NumberOfGrants))  # Arrange in descending order of number of grants
# Define custom colors for each Grantee Name (example)
custom_colors <- c("Grantee Name 1" = "red", "Grantee Name 2" = "blue", "Grantee Name 3" = "green")
# Then use scale_fill_manual in your ggplot call
ggplot(grants_per_grantee, aes(x = reorder(`Grantee Name`, NumberOfGrants), y = NumberOfGrants, fill = `Grantee Name`)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
# Other ggplot settings remain the same
library(readr)
library(dplyr)
library(ggplot2)
library(ggplot2)
# Assuming grants_per_grantee is your prepared dataset
# Define custom colors for each Grantee Name (example)
# Ensure you replace the placeholders with actual grantee names and desired colors
custom_colors <- c("Grantee Name 1" = "red", "Grantee Name 2" = "blue", "Grantee Name 3" = "green")
# Create the bar graph with custom colors
ggplot(grants_per_grantee, aes(x = reorder(`Grantee Name`, NumberOfGrants), y = NumberOfGrants, fill = `Grantee Name`)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
labs(title = "Number of Grants per Grantee",
x = "Grantee Name",
y = "Number of Grants") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))  # Rotate X-axis labels for better readability
# Load necessary libraries
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
# Read the CSV file
data <- read_csv("USDAallU.csv")
# Convert 'Award Date' to Date object using correct format and filter data from 2014 to 2024
data <- data %>%
mutate(AwardDate = mdy(`Award Date`)) %>%
filter(AwardDate >= as.Date("2014-01-01") & AwardDate <= as.Date("2024-12-31"))
# Aggregate data to get the total Award Dollars for each Grantee Name
total_award_per_grantee <- data %>%
group_by(`Grantee Name`) %>%
summarise(TotalAwardDollars = sum(`Award Dollars`, na.rm = TRUE)) %>%
arrange(desc(TotalAwardDollars)) # Optional: arrange in descending order of total award dollars
# Assuming total_award_per_grantee is already created from previous steps
# Convert Grantee Name to a factor (if not already)
total_award_per_grantee$`Grantee Name` <- factor(total_award_per_grantee$`Grantee Name`)
# Assuming custom_colors is correctly mapped to your Grantee Names
custom_colors <- c("Boise State University" = "blue",
"University of Idaho" = "gold",
"Washington State University" = "red",
"University of Montana" = "tan")
ggplot(total_award_per_grantee, aes(x = reorder(`Grantee Name`, TotalAwardDollars), y = TotalAwardDollars / 1e6, fill = `Grantee Name`)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = c("Boise State University" = "blue",
"University of Idaho" = "gold",
"Washington State University" = "red",
"University of Montana" = "tan")) +
labs(title = "USDA Total Award Dollars per University (2014-2024)",
x = "Univeristy",
y = "Total Award Dollars (Millions USD)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  # For better readability of Grantee Names
library(readr)
library(dplyr)
library(ggplot2)
library(ggplot2)
# Assuming grants_per_grantee is your prepared dataset
# Define custom colors for each Grantee Name (example)
# Ensure you replace the placeholders with actual grantee names and desired colors
custom_colors <- c("Grantee Name 1" = "red", "Grantee Name 2" = "blue", "Grantee Name 3" = "green")
# Create the bar graph with custom colors
ggplot(grants_per_grantee, aes(x = reorder(`Grantee Name`, NumberOfGrants), y = NumberOfGrants, fill = `Grantee Name`)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +
labs(title = "Number of USDA Grants per University (2014-2024)",
x = "University",
y = "Number of Grants") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))  # Rotate X-axis labels for better readability
# Load necessary libraries
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
# Read the CSV file
data <- read_csv("path_to_your_file.csv")
# Load necessary libraries
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
# Read the CSV file
data <- read_csv("USDAallU.csv")
# Convert 'Award Date' to Date object using correct format and filter data from 2014 to 2024
data <- data %>%
mutate(AwardDate = mdy(`Award Date`)) %>%
filter(AwardDate >= as.Date("2014-01-01") & AwardDate <= as.Date("2024-12-31"))
# Aggregate data to get the total Award Dollars for each Grantee Name
total_award_per_grantee <- data %>%
group_by(`Grantee Name`) %>%
summarise(TotalAwardDollars = sum(`Award Dollars`, na.rm = TRUE)) %>%
arrange(desc(TotalAwardDollars)) # Optional: arrange in descending order of total award dollars
# Create the bar charts
ggplot(total_award_per_grantee, aes(x = reorder(`Grantee Name`, TotalAwardDollars), y = TotalAwardDollars)) +
geom_bar(stat = "identity") +
labs(title = "Total Award Dollars per Grantee (2014-2024)",
x = "Grantee Name",
y = "Total Award Dollars") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))  # Rotate X-axis labels for better readability
# Load necessary libraries
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
grants_per_grantee <- funding_data %>%
group_by(Grantee Name) %>%
# Load necessary libraries
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
grants_per_grantee <- data %>%
group_by(Grantee Name) %>%
# Load necessary libraries
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
grants_per_grantee <- data%>%
group_by(Grantee Name) %>%
# Load necessary libraries
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
data <- read_csv("USDAallU.csv")
grants_per_grantee <- data %>%
group_by(Grantee Name) %>%
# Load necessary libraries
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
# Read the data
data <- read_csv("USDAallU.csv")
# Prepare the data by grouping and summarising
grants_per_grantee <- data %>%
group_by(`Grantee Name`) %>%  # Corrected: backticks around Grantee Name
summarise(NumberOfGrants = n()) %>%
arrange(desc(NumberOfGrants))  # Optional: arrange in descending order of number of grants
# Create the bar graph
ggplot(grants_per_grantee, aes(x = reorder(`Grantee Name`, NumberOfGrants), y = NumberOfGrants, fill = `Grantee Name`)) +
geom_bar(stat = "identity") +
labs(title = "Number of Grants per Grantee",
x = "Grantee Name",
y = "Number of Grants") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))  # Rotate X-axis labels for better readability
# Load necessary libraries
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
# Read the data
data <- read_csv("USDAallU.csv")
# Prepare the data by grouping and summarising
grants_per_grantee <- data %>%
group_by(`Grantee Name`) %>%
summarise(NumberOfGrants = n()) %>%
arrange(desc(NumberOfGrants))  # Optional: arrange in descending order of number of grants
# Define custom colors for specific Grantee Names
custom_colors <- c("Boise State University" = "blue",
"University of Idaho" = "gold",
"Washington State University" = "red",
"University of Montana" = "tan")
# Create the bar graph with custom colors
ggplot(grants_per_grantee, aes(x = reorder(`Grantee Name`, NumberOfGrants), y = NumberOfGrants, fill = `Grantee Name`)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +  # Apply custom colors
labs(title = "Number of Grants per Grantee",
x = "Grantee Name",
y = "Number of Grants") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =
# Load necessary libraries
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
# Read the data
data <- read_csv("USDAallU.csv")
# Prepare the data by grouping and summarising
grants_per_grantee <- data %>%
group_by(`Grantee Name`) %>%
summarise(NumberOfGrants = n()) %>%
arrange(desc(NumberOfGrants))  # Optional: arrange in descending order of number of grants
# Define custom colors for specific Grantee Names
custom_colors <- c("Boise State University" = "blue",
"University of Idaho" = "gold",
"Washington State University" = "red",
"University of Montana" = "tan")
# Create the bar graph with custom colors
ggplot(grants_per_grantee, aes(x = reorder(`Grantee Name`, NumberOfGrants), y = NumberOfGrants, fill = `Grantee Name`)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = custom_colors) +  # Apply custom colors
labs(title = "Number of Grants per Grantee",
x = "Grantee Name",
y = "Number of Grants") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))  # Rotate X-axis labels for better readability
library(readxl)
library(dplyr)
library(ggplot2)
library(lubridate)
# Read data from an Excel file
USDA10 <- read_xlsx("USDA10UI.xlsx")
# Convert start to Date objects
USDA10$start <- as.Date(USDA10$start, format = "%m/%d/%Y")
# Handle end date: Assuming you have only the year, create a Date object for December 31st of that year
USDA10$end <- as.Date(paste0(USDA10$end, "-12-31"), format = "%Y-%m-%d")
# Create the Gantt chart
ggplot(USDA10, aes(y = Agency, x = start, xend = end, yend = Agency)) +
geom_segment(size = 10, color = "green") + # Adjust the size as needed
scale_x_date(date_breaks = "1 year", date_labels = "%Y", limits = c(as.Date("2021-01-01"), as.Date("2029-01-01"))) +
labs(title = "10 years of active USDA funding",
x = "Timeline",
y = "Agency") +
theme_minimal() +
theme(legend.position = "bottom")
library(readxl)
library(dplyr)
library(ggplot2)
library(lubridate)
# Read data from an Excel file
USDA10 <- read_xlsx("USDA10UI.xlsx")
# Convert start to Date objects
USDA10$start <- as.Date(USDA10$start, format = "%m/%d/%Y")
# Handle end date: Assuming you have only the year, create a Date object for December 31st of that year
USDA10$end <- as.Date(paste0(USDA10$end, "-12-31"), format = "%Y-%m-%d")
# Create the Gantt chart
ggplot(USDA10, aes(y = Agency, x = start, xend = end, yend = Agency)) +
geom_segment(size = 10, color = "green") + # Adjust the size as needed
scale_x_date(date_breaks = "1 year", date_labels = "%Y", limits = c(as.Date("2021-01-01"), as.Date("2029-01-01"))) +
labs(title = "10 years of active USDA funding",
x = "Timeline",
y = "Agency") +
theme_minimal() +
theme(legend.position = "bottom")
library(readxl)
library(dplyr)
library(ggplot2)
library(lubridate)
# Read data from an Excel file
USDA10 <- read_xlsx("USDA10UI.xlsx")
# Convert start to Date objects
USDA10$start <- as.Date(USDA10$start, format = "%m/%d/%Y")
# Handle end date: Assuming you have only the year, create a Date object for December 31st of that year
USDA10$end <- as.Date(paste0(USDA10$end, "-12-31"), format = "%Y-%m-%d")
# Create the Gantt chart
ggplot(USDA10, aes(y = Agency, x = start, xend = end, yend = Agency)) +
geom_segment(size = 10, color = "green") + # Adjust the size as needed
scale_x_date(date_breaks = "1 year", date_labels = "%Y", limits = c(as.Date("2021-01-01"), as.Date("2029-01-01"))) +
labs(title = "10 years of active USDA funding",
x = "Timeline",
y = "Agency") +
theme_minimal() +
theme(legend.position = "bottom")
library(ggplot2)
library(dplyr)
library(lubridate)
df <- read_xlsx("UIawards.xlsx")
# Assuming your dataset is named df
# Clean 'Agency' data (remove leading/trailing spaces, check for case sensitivity)
df$Agency <- as.character(trimws(df$Agency))
# Convert 'start' and 'end' columns to Date format
df$start <- as.Date(df$start, format = "%Y-%m-%d")
df$end <- as.Date(df$end, format = "%Y-%m-%d")
# Create a timeline that spans 10 years back and 10 years forward from today
timeline_start <- Sys.Date() - years(10)
timeline_end <- Sys.Date() + years(10)
# Plotting
ggplot(df, aes(y = factor(Agency, levels = unique(Agency)), x = start, xend = end, yend = factor(Agency, levels = unique(Agency)))) +
geom_segment(size = 20, color = "blue") +  # Adjust size and color as needed
scale_x_date(limits = c(timeline_start, timeline_end), date_breaks = "1 year", date_labels = "%Y") +
labs(title = "10 years Timeline",
x = "Year",
y = "Agency") +
theme_minimal() +
theme(axis.text.y = element_text(size = 7),
panel.grid.major.x = element_line(color = "grey80"),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank())
library(readxl)
library(dplyr)
library(ggplot2)
library(lubridate)
library(RColorBrewer)
NIH10 <- read_xlsx("NIH10UI.xlsx")
# Aggregate data to get the total amount per PI and filter out amounts smaller than 200000
total_amount_per_PI <- NIH10 %>%
group_by(PI) %>%
summarise(TotalAmount = sum(Amount, na.rm = TRUE)) %>%
filter(TotalAmount >= 200000) %>%  # Filter step added here
arrange(desc(TotalAmount))
ggplot(total_amount_per_PI, aes(x = PI, y = TotalAmount / 1e6)) +
geom_bar(stat = "identity") +
labs(title = "NIH Total Funding per PI in the Last 10 Years",
y = "Total Funding Amount (USD Millions)",
x = "Principal Investigator") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate X-axis labels for readability
library(readxl)
library(dplyr)
library(ggplot2)
library(readxl)
library(dplyr)
library(ggplot2)
funding_data <- read_xlsx("UIawards2.xlsx")
# Count the unique PIs per agency
pi_count_per_agency <- funding_data %>%
group_by(Agency) %>%
summarise(PI_Count = n_distinct(PI))
# Filter for the specific agencies if the dataset contains more agencies
pi_count_per_agency <- pi_count_per_agency %>%
filter(Agency %in% c("NSF", "NIH", "DOE"))
# Create the bar chart
ggplot(pi_count_per_agency, aes(x = Agency, y = PI_Count, fill = Agency)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Total number of PIs Per Agency in UofI recent history",
x = "Agency",
y = "Number of PIs") +
theme_minimal() +
scale_fill_brewer(palette = "Set2")
